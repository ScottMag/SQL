-- ADVENTUREWORKS: SQL EXERCISES, PRACTICE, SOLUTION 
-- HTTPS://WWW.W3RESOURCE.COM/SQL-EXERCISES/ADVENTUREWORKS/ADVENTUREWORKS-EXERCISES.PHP

--------------------------------------------------------------------------------------
-- 1. FROM THE FOLLOWING TABLE WRITE A QUERY IN SQL TO RETRIEVE ALL ROWS AND COLUMNS 
-- FROM THE EMPLOYEE TABLE IN THE ADVENTUREWORKS DATABASE. SORT THE RESULT SET IN 
-- ASCENDING ORDER ON JOBTITLE. 

SELECT *
FROM HUMANRESOURCES.EMPLOYEE
ORDER BY JOBTITLE ASC;

--------------------------------------------------------------------------------------
-- 2. FROM THE FOLLOWING TABLE WRITE A QUERY IN SQL TO RETRIEVE ALL ROWS AND COLUMNS 
-- FROM THE EMPLOYEE TABLE USING TABLE ALIASING IN THE ADVENTUREWORKS DATABASE. 
-- SORT THE OUTPUT IN ASCENDING ORDER ON LASTNAME. 

SELECT *
FROM PERSON.PERSON
ORDER BY LASTNAME ASC;

--------------------------------------------------------------------------------------
-- 3. FROM THE FOLLOWING TABLE WRITE A QUERY IN SQL TO RETURN ALL ROWS AND A SUBSET OF 
-- THE COLUMNS (FIRSTNAME, LASTNAME, BUSINESSENTITYID) FROM THE PERSON TABLE IN THE 
-- ADVENTUREWORKS DATABASE. THE THIRD COLUMN HEADING IS RENAMED TO EMPLOYEE_ID. 
-- ARRANGED THE OUTPUT IN ASCENDING ORDER BY LASTNAME. 

SELECT FIRSTNAME, 
       LASTNAME, 
	   BUSINESSENTITYID AS EMPLOYEE_ID
FROM PERSON.PERSON
ORDER BY LASTNAME ASC;

--------------------------------------------------------------------------------------
-- 4. FROM THE FOLLOWING TABLE WRITE A QUERY IN SQL TO RETURN ONLY THE ROWS FOR PRODUCT 
-- THAT HAVE A SELLSTARTDATE THAT IS NOT NULL AND A PRODUCTLINE OF 'T'. RETURN PRODUCTID, 
-- PRODUCTNUMBER, AND NAME. ARRANGED THE OUTPUT IN ASCENDING ORDER ON NAME. 

SELECT PRODUCTID,
	   PRODUCTNUMBER,
	   NAME AS PRODUCTNAME
FROM PRODUCTION.PRODUCT
WHERE SELLSTARTDATE IS NOT NULL
AND   PRODUCTLINE = 'T'
ORDER BY NAME ASC;

--------------------------------------------------------------------------------------
-- 5. FROM THE FOLLOWING TABLE WRITE A QUERY IN SQL TO RETURN ALL ROWS FROM THE 
-- SALESORDERHEADER TABLE IN ADVENTUREWORKS DATABASE AND CALCULATE THE PERCENTAGE OF TAX 
-- ON THE SUBTOTAL HAVE DECIDED. RETURN SALESORDERID, CUSTOMERID, ORDERDATE, SUBTOTAL, 
-- PERCENTAGE OF TAX COLUMN. ARRANGED THE RESULT SET IN ASCENDING ORDER ON SUBTOTAL. 

SELECT SALESORDERID,
	   CUSTOMERID,
	   ORDERDATE,
	   SUBTOTAL,
	   100.00 * SUM(TAXAMT) / SUM(SUBTOTAL) AS TAX_PERCENT
FROM SALES.SALESORDERHEADER
GROUP BY SALESORDERID,
	     CUSTOMERID,
	     ORDERDATE,
	     SUBTOTAL
ORDER BY SUBTOTAL DESC;

--------------------------------------------------------------------------------------
-- 6. FROM THE FOLLOWING TABLE WRITE A QUERY IN SQL TO CREATE A LIST OF UNIQUE JOBTITLES 
-- IN THE EMPLOYEE TABLE IN ADVENTUREWORKS DATABASE. RETURN JOBTITLE COLUMN AND ARRANGED 
-- THE RESULTSET IN ASCENDING ORDER. 

SELECT JOBTITLE
FROM HUMANRESOURCES.EMPLOYEE
GROUP BY JOBTITLE
ORDER BY JOBTITLE ASC;

--------------------------------------------------------------------------------------
-- 7. FROM THE FOLLOWING TABLE WRITE A QUERY IN SQL TO CALCULATE THE TOTAL FREIGHT PAID 
-- BY EACH CUSTOMER. RETURN CUSTOMERID AND TOTAL FREIGHT. SORT THE OUTPUT IN ASCENDING 
-- ORDER ON CUSTOMERID. 

SELECT CUSTOMERID,
	   SUM(FREIGHT)
FROM SALES.SALESORDERHEADER
GROUP BY CUSTOMERID
ORDER BY CUSTOMERID ASC;

--------------------------------------------------------------------------------------
-- 8. FROM THE FOLLOWING TABLE WRITE A QUERY IN SQL TO FIND THE AVERAGE AND THE SUM OF 
-- THE SUBTOTAL FOR EVERY CUSTOMER. RETURN CUSTOMERID, AVERAGE AND SUM OF THE SUBTOTAL.
-- GROUPED THE RESULT ON CUSTOMERID AND SALESPERSONID. SORT THE RESULT ON CUSTOMERID 
-- COLUMN IN DESCENDING ORDER. 

SELECT CUSTOMERID,
	   SALESPERSONID,
	   AVG(SUBTOTAL) AS AVG_SUBTOTAL,
	   SUM(SUBTOTAL) AS SUM_SUBTOTAL
FROM SALES.SALESORDERHEADER
GROUP BY CUSTOMERID,
	     SALESPERSONID
ORDER BY CUSTOMERID DESC;

--------------------------------------------------------------------------------------
-- 9. FROM THE FOLLOWING TABLE WRITE A QUERY IN SQL TO RETRIEVE TOTAL QUANTITY OF EACH 
-- PRODUCTID WHICH ARE IN SHELF OF 'A' OR 'C' OR 'H'. FILTER THE RESULTS FOR SUM QUANTITY 
-- IS MORE THAN 500. RETURN PRODUCTID AND SUM OF THE QUANTITY. SORT THE RESULTS ACCORDING 
-- TO THE PRODUCTID IN ASCENDING ORDER. 

SELECT PRODUCTID,
	   SUM(QUANTITY) AS TOTAL_QUANTITY
FROM PRODUCTION.PRODUCTINVENTORY
WHERE SHELF IN ('A', 'C', 'H')
GROUP BY PRODUCTID;

--------------------------------------------------------------------------------------
-- 10. FROM THE FOLLOWING TABLE WRITE A QUERY IN SQL TO FIND THE TOTAL QUENTITY FOR A 
-- GROUP OF LOCATIONID MULTIPLIED BY 10. 

SELECT SUM(Quantity) AS TOTAL_QUANTITY
FROM production.productinventory
GROUP BY (LOCATIONID * 10);

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------
