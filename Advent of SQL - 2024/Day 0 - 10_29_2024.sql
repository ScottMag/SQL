-- Find the top 3 cities in each country with the highest average naughty_nice_score for children who received gifts, 
-- but only include cities with at least 5 children. 
----------------------------------------------------------------------------------------------------
SELECT * 
FROM CHRISTMASLIST;
----------------------------------------------------------------------------------------------------
SELECT *
FROM CHILDREN;
----------------------------------------------------------------------------------------------------
SELECT *
FROM GIFTS;
----------------------------------------------------------------------------------------------------
SELECT *
FROM REINDEER;
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
SELECT DISTINCT CITY, COUNTRY, AVG(NAUGHTY_NICE_SCORE) AS AVG_SCORE
FROM CHILDREN C
LEFT JOIN CHRISTMASLIST CL
ON CL.CHILD_ID = C.CHILD_ID
WHERE WAS_DELIVERED = 1
GROUP BY CITY, COUNTRY
HAVING COUNT(DISTINCT C.CHILD_ID) >= 5
ORDER BY AVG(NAUGHTY_NICE_SCORE) DESC
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
